<div *ngIf="guild.guildId == null">
    <h1>Please select a Guild</h1>
</div>
<div *ngIf="guild.guildId != null" class="col-sm-12">

    <div class="row guildTitle">

        <span *ngIf="!editMode">
            <h2>
                {{guild.name}}
            </h2>
        </span>
        <input *ngIf="editMode" #name (keyup)="onKey(name.value)">       

        <span class="glyphicon glyphicon-pencil" aria-hidden="true" (click)="editModeToggle()"></span>

    </div>

    <div class="row">
        <div class="row teamsTitle">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <span>Teams</span>
            </div>
        </div>

        <div class="row">
            <teams></teams>
        </div>
    </div>


    <div class="row">        
        <div class="row teamActionSummaryTitle">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <span>Team Action Summary</span>
            </div>
        </div>
        <div  *ngFor="let team of guild?.teams" class="col-sm-2 well">
            <div class="row">
                <span>Team {{team.teamId}}</span>
            </div>
            <!--<div class="row">
                <span>Zone {{team.currentZone}}</span>
            </div>-->
            <div *ngIf="team.dungeonId != 0" class="row">
                <span>Dungeon {{team.dungeonId}}</span>
            </div>
            <div *ngIf="team.dungeonId == 0" class="row">
                <span>Team Idle</span>
            </div>
            <div class="row">
                <span *ngIf="team.timeRemaining > 0">{{team.timeRemaining}} seconds remaining</span>
                <button *ngIf="team.timeRemaining <= 0 && team.dungeonId != 0" type="button" class="btn btn-default" (click)="completeDungeon(team.teamId)">Click to Complete</button>
            </div>
        </div>
    </div>

    <!--Equipment Summary-->
    <div class="row">
        <div class="row equipmentTitle">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <span>Equipment</span>
            </div>
        </div>
        <div *ngFor="let equipment of guild?.guildInventory.equippableItems; let i = index" class="col-sm-2 well">
            
            <div class="row">
                <span>{{equipment?.name}}</span>
            </div>

            <div class="row">
                <span>Bonus Stats</span>
            </div>

            <div class="row">
                <div class="col-xs-2 col-sm-2 col-md-2 col-lg-2">
                    <span>S: {{equipment?.bonusStats?.base.strength}}</span>
                </div>
                <div class="col-xs-2 col-sm-2 col-md-2 col-lg-2">
                    <span>A: {{equipment?.bonusStats?.base.agility}}</span>
                </div>
                <div class="col-xs-2 col-sm-2 col-md-2 col-lg-2">
                    <span>D: {{equipment?.bonusStats?.base.dexterity}}</span>
                </div>
                <div class="col-xs-2 col-sm-2 col-md-2 col-lg-2">
                    <span>I: {{equipment?.bonusStats?.base.intelligence}}</span>
                </div>
                <div class="col-xs-2 col-sm-2 col-md-2 col-lg-2">
                    <span>V: {{equipment?.bonusStats?.base.vitality}}</span>
                </div>
                <div class="col-xs-2 col-sm-2 col-md-2 col-lg-2">
                    <span>F: {{equipment?.bonusStats?.base.focus}}</span>
                </div>
            </div>

        </div>
    </div>

    <!--Character Summary-->
    <div class="row">
        <div class="row characterTitle">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <span>Characters</span>
            </div>
        </div>
        <div *ngFor="let character of guild?.characters; let i = index" class="col-sm-2 well">
            
            <div class="row">
                <span *ngIf="!character.editMode">{{character?.name}}</span>
                <input *ngIf="character.editMode" #characterName (keyup)="onKeyCharacter(characterName.value)">
                <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown" (click)="editModeToggleCharacter(character.unitId)">
                        Edit</button>
            </div>

            <div class="row">
                <span>HP: {{character?.stats?.base.vitality | vitToHp}}</span>
            </div>

            <div class="row">
                <div class="col-xs-2 col-sm-2 col-md-2 col-lg-2">
                    <span>S: {{character?.stats?.base.strength}}</span>
                </div>
                <div class="col-xs-2 col-sm-2 col-md-2 col-lg-2">
                    <span>A: {{character?.stats?.base.agility}}</span>
                </div>
                <div class="col-xs-2 col-sm-2 col-md-2 col-lg-2">
                    <span>D: {{character?.stats?.base.dexterity}}</span>
                </div>
                <div class="col-xs-2 col-sm-2 col-md-2 col-lg-2">
                    <span>I: {{character?.stats?.base.intelligence}}</span>
                </div>
                <div class="col-xs-2 col-sm-2 col-md-2 col-lg-2">
                    <span>V: {{character?.stats?.base.vitality}}</span>
                </div>
                <div class="col-xs-2 col-sm-2 col-md-2 col-lg-2">
                    <span>F: {{character?.stats?.base.focus}}</span>
                </div>
            </div>

        </div>
    </div>

    <div class="row">
        <div class="row cardTitle">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <span>Card Inventory</span>
                <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown" (click)="pullCharacterCard()">
                    Pull New Character</button>
            </div>
        </div>
        <div *ngFor="let card of guild?.guildInventory?.characterCards; let i = index" class="col-sm-2 well">
            
            <div class="row">
                <span>{{card?.name}}</span>
            </div>

            <div class="row">
                <span>HP: {{card?.vitality | vitToHp}}</span>
            </div>

            <div class="row">
                <div class="col-xs-2 col-sm-2 col-md-2 col-lg-2">
                    <span>S: {{card?.strength}}</span>
                </div>
                <div class="col-xs-2 col-sm-2 col-md-2 col-lg-2">
                    <span>A: {{card?.agility}}</span>
                </div>
                <div class="col-xs-2 col-sm-2 col-md-2 col-lg-2">
                    <span>D: {{card?.dexterity}}</span>
                </div>
                <div class="col-xs-2 col-sm-2 col-md-2 col-lg-2">
                    <span>I: {{card?.intelligence}}</span>
                </div>
                <div class="col-xs-2 col-sm-2 col-md-2 col-lg-2">
                    <span>V: {{card?.vitality}}</span>
                </div>
                <div class="col-xs-2 col-sm-2 col-md-2 col-lg-2">
                    <span>F: {{card?.focus}}</span>
                </div>
                <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown" (click)="redeemCharacterCard(card)">
                    Redeem</button>
            </div>

        </div>

        <!--<li *ngFor="let card of guild?.guildInventory?.characterCards">
            <span>{{card.name}}</span>
            <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown" (click)="redeemCharacterCard(card)">
                Redeem</button>
        </li>-->
    </div>
    
    <div class="row guildHistory">
        <div class="row guildHistoryTitle">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <span>Guild History</span>
                <button type="button" class="btn btn-default" (click)="getGuildHistory(guild?.guildId)">Load/Refresh</button>
            </div>
        </div>

        <div class="row">
            <div class="col-xs-3 col-sm-3 col-md-3 col-lg-3">
                <div *ngFor="let history of guildHistories; let idx = index">
                    <div class="row well">
                        <span (click)="viewReceipt(idx, history.receiptType)">{{history.createdOn | date:'EEEE, MMMM dd, y, hh:mm:ss a'}}</span>
                    </div>
                </div>
            </div>
            <div *ngIf="fightReceipt.Success != null" class="well col-xs-8 col-sm-8 col-md-8 col-lg-8">
                <div class="row">
                    <span>Player Win?: {{fightReceipt?.Success}}</span>
                </div>
                <div class="row">
                    <span>Gold: {{fightReceipt?.Gold}}</span>
                </div>
                <div class="row">
                    <div *ngFor="let wave of fightReceipt.FightLog; let idx = index">
                        <span>Wave: {{idx + 1}}</span>
                        <div *ngFor="let event of wave">
                            <span>{{event.Message}}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>